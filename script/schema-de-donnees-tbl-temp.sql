-- 1- ACTIF_DATA_ET_DATE_ACTIVATION

CREATE EXTERNAL TABLE OIC.TT_ACTIF_DATA_ET_DATE_ACTIVATION (
  MSISDN STRING,
  DATE_ACTIVATION STRING
  );

-- 2- BUNDLE

CREATE TABLE OIC.TT_BUNDLE (
  DATE_SOUSCRIPTION STRING,
  MSISDN STRING,
  TYPE_SOUSCRIPTION STRING,
  NOMBRE_SOUSCRIPTION STRING,
  MONTANT_SOUSCRIPTION STRING
  );
               
-- 3- CDR	
-- 3-1- cdr_traffic_customer_cell

CREATE TABLE OIC.TT_CDR_TRAFFIC_CUSTOMER_CELL (
  day STRING,
  idCust STRING,
  idGGSN STRING,
  idRAT STRING,
  idTAC STRING,
  idCell STRING,
  roaming STRING,
  nBytesDn STRING,
  nBytesUp STRING
  );

-- 3-2- cdr_traffic_customer

CREATE TABLE OIC.TT_CDR_TRAFFIC_CUSTOMER (
  day STRING,
  idCust STRING,
  idAppli STRING,
  idAPN STRING,
  idTAC STRING,
  idRAT STRING,
  idGGSN STRING,
  Roaming STRING,
  nBytesDn STRING,
  nBytesUp STRING,
  nBytesT STRING,
  Terminal_type STRING,
  Terminal_brand STRING,
  Terminal_model STRING,
  Subscriber_type STRING,
  Service_type STRING,
  idContract STRING
  );

-- 3-3- Conversions_Id; Table = OIC.TT_CONVERSIONS_ID_*;
-- Table = OIC.TT_CONVERSIONS_ID_APN;

CREATE TABLE OIC.TT_CONVERSIONS_ID_APN (
  Id_APN STRING,
  Description_APN STRING
  );

-- Table = OIC.TT_CONVERSIONS_ID_APPLI;

CREATE TABLE OIC.TT_CONVERSIONS_ID_APPLI (
  Id_appli STRING,
  Description_appli STRING
  );

-- Table = OIC.TT_CONVERSIONS_ID_CUST_CONTACT;

CREATE TABLE OIC.TT_CONVERSIONS_ID_CUST_CONTACT (
  Id_cust_contract String,
  Description_Contract STRING
  );

-- Table = OIC.TT_CONVERSIONS_ID_GGSN;

CREATE TABLE OIC.TT_CONVERSIONS_ID_GGSN (
  Id_GGSN String,
  Description_GGSN STRING,
  Address_GGSN STRING
  );

-- Table = OIC.TT_CONVERSIONS_ID_RAT;

CREATE TABLE OIC.TT_CONVERSIONS_ID_RAT (
  Id_RAT STRING,
  Description_RAT STRING
  );

-- Table = OIC.TT_CONVERSIONS_ID_CUST_MSISDN;

CREATE TABLE OIC.TT_CONVERSIONS_ID_CUST_MSISDN (
  Id_customer STRING,
  MSISDN STRING
  );

-- 3-4- Localisation_cellules; Table = OIC.TT_CDR_LOCALISATION_CELLULES;

CREATE TABLE OIC.TT_CDR_LOCALISATION_CELLULES (
  Id_Dashotarie String,
  cgi String,
  bsc String,
  msc String,
  utrancell String,
  nodob String,
  rnc String,
  cell String,
  enodeb String,
  lat String,
  lon String,
  GEOLOC String,
  COMMUNE String,
  DEPARTEMENT String,
  REGION String,
  DISTRICT String
  );

-- 4- DONNEES_HISTO_MENSUELLES

CREATE TABLE OIC.TT_DONNEES_HISTO_MENSUELLES (
  MONTH_ID STRING,
  MSISDN STRING,
  GEOLOCALITE STRING,
  COMMUNE STRING,
  DEPARTEMENT STRING,
  REGION STRING,
  REGION_CAT STRING,
  DISTRIBUTEUR STRING,
  DATE_ACTIVATION STRING,
  STATUT_OM STRING,
  STATUT_MSIM STRING,
  STATUT_MOOV STRING,
  STATUT_MTN STRING,
  SEGMENT_VALEUR STRING,
  PLAN_TARIFAIRE STRING,
  MONTANT_RECHARGE STRING,
  REV_TOT_CONSOMME STRING,
  REV_SORTANT STRING,
  REV_ENTRANT STRING,
  REV_VOIX STRING,
  REV_SMS STRING,
  REV_DATA STRING,
  REV_PASS STRING,
  REV_SVA STRING,
  VOL_TOT_VOIX_SORTANT STRING,
  NB_TOT_VOIX_SORTANT STRING,
  NB_TOT_SMS_SORTANT STRING,
  NB_VOIX_OFFNET_SORTANT STRING,
  NB_VOIX_ONNET_SORTANT STRING,
  NB_VOIX_INTER STRING,
  NB_VOIX_ROAM_SORTANT STRING,
  NB_VOIX_ROAM_ENTRANT STRING,
  NB_SMS_OFFNET_SORTANT STRING,
  NB_SMS_INTER_SORTANT STRING,
  NB_SMS_ONET_SORTANT STRING,
  NB_SMS_ROAM_SORTANT STRING,
  VOL_TOT_VOIX_OFFNET_SORTANT STRING,
  VOL_TOT_VOIX_ONNET_SORTANT STRING,
  VOL_TOT_VOIX_INTER_SORTANT STRING,
  VOL_VOIX_ROAM_SORTANT STRING,
  VOL_VOIX_ROAM_ENTRANT STRING,
  VOL_DATA_ROAM STRING,
  VOL_CONSOMME STRING
  );

-- 5- ENTRANT	

CREATE TABLE OIC.TT_CDR_ENTRANT (
  DATE_ID STRING,
  MSISDN STRING,
  MSISDN_APPELANT STRING,
  MSISDN_APPELE STRING,
  DESTINATION STRING,
  TYPE_EVENT STRING,
  SENS_EVENT STRING,
  OPERATEUR_APPELE STRING,
  OPERATEUR_APPELANT STRING,
  TYPE_CELLULE STRING,
  CI STRING,
  DUREE_EVENT STRING,
  MONTANT_VALORISE STRING,
  MONTANT_BUNDLE STRING,
  MONTANT_BONUS STRING,
  VOL_DATA_CONSOMME STRING,
  VOL_DATA_DOWN STRING,
  VOL_DATA_UP STRING
  );

-- 6- INFO_TERMINAUX	

CREATE TABLE OIC.TT_INFO_TERMINAUX (
  DATE_ID STRING,
  MSISDN STRING,
  CODE_TAC STRING,
  MODELE STRING,
  MARQUE STRING,
  DEVICE_TYPE STRING
  );

-- 7- MSIM	

CREATE TABLE OIC.TT_MSIM (
  MSISDN String,
  STATUT_ORANGE String,
  STATUT_MTN String,
  STATUT_MOOV String
  );

-- 8- RECHARGE	

CREATE TABLE OIC.TT_RECHARGE (
  DATE_RECHARGEMENT STRING,
  MSISDN STRING,
  TYPE_RECHARGEMENT STRING,
  MONTANT_RECHARGEMNT STRING,
  NOMBRE_RECHARGEMNT STRING
  );

-- 9- REFERENTIEL_TERMINAUX

CREATE TABLE OIC.TT_REFERENTIEL_TERMINAUX (
  TAC STRING,
  PRODUCT_ID STRING,
  SUPPLIER_NAME	 STRING,
  MODEL_NAME STRING,
  MODEL_NAME_OTHER STRING,
  DEVICE_TYPE STRING,
  SMARTPHONE_FLAG STRING,
  PLATFORM STRING,
  ADRESSBOOK_INTEGR STRING,
  A_GPS STRING,
  BLUETOOTH_FLAG STRING,
  BLUETOOTH STRING,
  BROWSER STRING,
  BROWSING_LEVEL STRING,
  CALCULATED_DP STRING,
  CALL_HARD_KEY_FLAG STRING,
  CAMERA_FLAG STRING,
  CAMERA_FLASH_FLAG STRING,
  CAMERA_RESOLUTION STRING,
  CAMERA STRING,
  CAMERA_ZOOM_FLAG STRING,
  CATEGORY STRING,
  CHARGE_USB_FLAG STRING,
  COLOUR_SCREEN_FLAG STRING,
  COMPASS_FLAG STRING,
  CONNECT_DEVICE STRING,
  CONTACT_CONTENT STRING,
  DEST_POP_UP_FLAG STRING,
  DIMENSIONS STRING,
  DOWNLOADABLE STRING,
  DP_MARKETING STRING,
  DP_TEK STRING,
  DRM_FOR_MUSIC_FLAG STRING,
  DRM_FOR_VIDEO STRING,
  DVBH_FLAG STRING,
  DVP_CONFIRMATION STRING,
  EDGE_FLAG STRING,
  EDGE STRING,
  EMAIL_WIZ STRING,
  FM_RADIO_FLAG STRING,
  FORM_FACTOR STRING,
  GPRS_FLAG STRING,
  GPRS_MULTISLOT_CLASS STRING,
  GSM_BAND STRING,
  GSM_BAND_FLAG STRING,
  HANDSFREE_SPEAKER_FLAG STRING,
  HANG_UP_HARD_KEY_FLAG STRING,
  HDVOICE_FLAG STRING,
  HEADSET STRING,
  HOME_SCREEN_FLAG STRING,
  HOMESCREEN_PAGE_NO STRING,
  HOMESCREEN_VERSION STRING,
  HSDPA_CATEGORY STRING,
  HSDPA_FLAG STRING,
  HSUPA_CATEGORY STRING,
  HSUPA_FLAG STRING,
  HTML_FLAG STRING,
  HTML_VERSION STRING,
  INSTANT_MSG_CLIENT STRING,
  IS_BUNDLE STRING,
  JAVA_VERSION STRING,
  JOYN STRING,
  JSR STRING,
  KEYBOARD STRING,
  LAUNCH_DATE_COME STRING,
  LENGHT_MM STRING,
  LOCAL_SYNCHRONISATION STRING,
  LTE STRING,
  MANUFACTURER_BUNDLE STRING,
  MEMORY_TYPE_EXT STRING,
  MMS_FLAG STRING,
  MODEL_NACODE_BUNDLE STRING,
  MODEM STRING,
  MOUSE_FLAG STRING,
  MULTITOUCH_FLAG STRING,
  MUSIC_PLAYER_FLAG STRING,
  NB_CPU_FOR_MM STRING,
  NFC_FLAG STRING,
  NFC_TAG_READING_WRITING STRING,
  NUMBER_OF_SIGNATURE_APPS STRING,
  OPEN_OS_FLAG STRING,
  ORANGE_APP_SHOP STRING,
  ORANGE_GAMES STRING,
  ORANGE_HARD_KEY_FLAG STRING,
  ORANGE_MAPS STRING,
  ORANGE_MUSIC_STORE_FLAG STRING,
  ORANGE_TVPLAYER STRING,
  ORANGE_WIDGETS STRING,
  OS STRING,
  OS_VERSION STRING,
  OTHER_GAMING_SOLUTION STRING,
  OTHER_OS STRING,
  PUSH_MAIL_FLAG STRING,
  RCS STRING,
  REPORTING_NAME STRING,
  RING_TONES STRING,
  SCREEN_SIZE_INCH STRING,
  SCREEN_SIZE_PIXELS STRING,
  SCREEN_TYPE STRING,
  SEGMENTATION_FINANCE STRING,
  SIGNATURE_FLAG STRING,
  SIM_EMULATION STRING,
  SOCIAL_NETWORK_CLIENT STRING,
  STANDARD_MAIL_FLAG STRING,
  STREAMING STRING,
  SYNCHRO_PC_PLAYER_FLAG STRING,
  TEK_RADIO STRING,
  THREAD_MESSAGE_FLAG STRING,
  TOUCH_SCREEN_FLAG STRING,
  TV_HARD_KEY_FLAG STRING,
  TV_OUT_LINK_SUPPORT_FLAG STRING,
  UMA_FLAG STRING,
  UMTS_FLAG STRING,
  UMTS_BAND STRING,
  USAGE_CATEGORY STRING,
  USAGE_SUBCATEGORY STRING,
  USAGE_CATEGORY_LEVEL STRING,
  USB STRING,
  USER_INT_MEMORY STRING,
  VIBRATOR_FLAG STRING,
  VIDEO_PLAYER STRING,
  VIDEO_PLAYER_FLAG STRING,
  VIDEOTELEPHONY_FLAG STRING,
  VOICE_MAIL_DIRECT_ACCESS STRING,
  VOLUME_CC STRING,
  WAP_FLAG STRING,
  WAP_PUSH STRING,
  WAP_VERSION STRING,
  WEIGHT_GR STRING,
  WIFI_FLAG STRING,
  XHTML STRING
  );

-- 10- SORTANT

CREATE TABLE OIC.TT_CDR_SORTANT (
  DATE_ID STRING,
  MSISDN STRING,
  MSISDN_APPELANT STRING,
  MSISDN_APPELE STRING,
  DESTINATION STRING,
  TYPE_EVENT STRING,
  SENS_EVENT STRING,
  OPERATEUR_APPELANT STRING,
  OPERATEUR_APPELE STRING,
  TYPE_CELLULE STRING,
  CI STRING,
  DUREE_EVENT STRING,
  MONTANT_VALORISE STRING,
  MONTANT_BUNDLE STRING,
  MONTANT_BONUS STRING,
  VOL_DATA_CONSOMME STRING,
  VOL_DATA_DOWN STRING,
  VOL_DATA_UP STRING
  );

-- 11- SVA	

CREATE TABLE OIC.TT_SVA (
  MONTH_ID STRING,
  MSISDN STRING,
  TYPE_SOUSCRIPTION STRING,
  NOMBRE_SOUSCRIPTION STRING,
  MONTANT_SOUSCRIPTION STRING
  );

-- 12- TRANSACTION_OM

CREATE TABLE OIC.TT_TRANSACTION_OM (
  MONTH_ID STRING,
  MSISDN STRING,
  NBRE_TRANSACTION STRING,
  MONTANT_TRANSACTION STRING,
  NBRE_TRANSACTION_IN STRING,
  MONTANT_TRANSACTION_IN STRING,
  NBRE_TRANSACTION_OUT STRING,
  MONTANT_TRANSACTION_OUT STRING
  );

-----------------------------------------------------------
-----------------------------------------------------------
-- 13- Service Provider per Day

CREATE TABLE OIC.TT_customers_sp_day_201611(
  id_cust string,
  serv_provider string
  );

--
CREATE TABLE OIC.TT_customers_sp_day_201612(
  id_cust string,
  serv_provider string
  );

--

CREATE TABLE OIC.TT_customers_sp_day_201701(
  id_cust string,
  serv_provider string
  );

--
CREATE TABLE OIC.TT_customers_sp_day_201702(
  id_cust string,
  serv_provider string
  );

--
CREATE TABLE OIC.TT_customers_sp_day_201703(
  id_cust string,
  serv_provider string
  );

--
CREATE TABLE OIC.TT_customers_sp_day_201704(
  id_cust string,
  serv_provider string
  );

-- 14- Service Provider per month

CREATE TABLE OIC.TT_customers_sp_month_201611(
  id_cust string,
  serv_provider string
  );

--
CREATE TABLE OIC.TT_customers_sp_month_201612(
  id_cust string,
  serv_provider string
  );

--
CREATE TABLE OIC.TT_customers_sp_month_201701(
  id_cust string,
  serv_provider string
  );

--
CREATE TABLE OIC.TT_customers_sp_month_201702(
  id_cust string,
  serv_provider string
  );

--
CREATE TABLE OIC.TT_customers_sp_month_201703(
  id_cust string,
  serv_provider string
  );

--
CREATE TABLE OIC.TT_customers_sp_month_201704(
  id_cust string,
  serv_provider string
  );

CREATE TABLE OIC.TT_customers_sp_month_201705(
  id_cust string,
  serv_provider string,
  Period string
  );
